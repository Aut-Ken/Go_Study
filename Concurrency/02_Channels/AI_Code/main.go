package main

import (
	"fmt"
	"time"
)

// å¨å¸ˆï¼šåªè´Ÿè´£å¾€ç®¡é“é‡Œã€å‘é€ã€‘æ•°æ®
// chan<- string è¡¨ç¤ºè¿™ä¸ªç®¡é“åœ¨è¿™ä¸ªå‡½æ•°é‡Œåªèƒ½å†™ï¼Œä¸èƒ½è¯»ï¼ˆå•å‘ç®¡é“ï¼Œä¸ºäº†å®‰å…¨ï¼‰
func chef(ch chan<- string) {
	fmt.Println("ğŸ‘¨â€ğŸ³ å¨å¸ˆ: å¼€å§‹ä¸Šç­äº†ï¼")

	for i := 1; i <= 3; i++ {
		dish := fmt.Sprintf("æ‹›ç‰Œçº¢çƒ§è‚‰ #%d", i)

		fmt.Println("ğŸ‘¨â€ğŸ³ å¨å¸ˆ: æ­£åœ¨å…¨åŠ›çˆ†ç‚’...", dish)
		time.Sleep(1 * time.Second) // æ¨¡æ‹Ÿåšèœè€—æ—¶

		// ã€å…³é”®åŠ¨ä½œã€‘æŠŠèœæ”¾è¿›ç®¡é“
		// å¦‚æœç®¡é“é‡Œæœ‰ä¸œè¥¿æ²¡äººæ‹¿ï¼Œå¨å¸ˆä¼šåœ¨è¿™é‡Œå¡ä½ï¼ˆé˜»å¡ï¼‰ï¼Œç›´åˆ°æœåŠ¡å‘˜æ‹¿èµ°
		fmt.Println("ğŸ‘¨â€ğŸ³ å¨å¸ˆ: èœåšå¥½äº†ï¼Œæ”¾åœ¨çª—å£ç­‰å¾…å–é¤ ->", dish)
		ch <- dish
	}

	// èœåšå®Œäº†ï¼Œå…³ç¯ä¸‹ç­
	// ã€å…³é”®åŠ¨ä½œã€‘å…³é—­ç®¡é“ï¼Œé€šçŸ¥æœåŠ¡å‘˜æ²¡èœäº†
	close(ch)
	fmt.Println("ğŸ‘¨â€ğŸ³ å¨å¸ˆ: ä¹Ÿå°±æ˜¯ä¸ªé”…é“²æŠŠå­ï¼Œä¸‹ç­ï¼")
}

// æœåŠ¡å‘˜ï¼šåªè´Ÿè´£ä»ç®¡é“é‡Œã€æ¥æ”¶ã€‘æ•°æ®
// <-chan string è¡¨ç¤ºåªè¯»
func waiter(ch <-chan string) {
	fmt.Println("ğŸ’ æœåŠ¡å‘˜: å‡†å¤‡æ¥å®¢...")

	// range ä¼šä¸€ç›´ä»ç®¡é“å–æ•°æ®ï¼Œç›´åˆ°ç®¡é“è¢« close æ‰ä¼šè·³å‡ºå¾ªç¯
	for dish := range ch {
		fmt.Println("ğŸ’ æœåŠ¡å‘˜: æ‹¿åˆ°èœäº† ->", dish)
		time.Sleep(2 * time.Second) // æ¨¡æ‹Ÿç«¯èœèµ°çš„è€—æ—¶
		fmt.Println("ğŸ’ æœåŠ¡å‘˜: å®¢äººåƒå®Œäº†")
	}

	fmt.Println("ğŸ’ æœåŠ¡å‘˜: å¨å¸ˆä¸‹ç­äº†ï¼Œæˆ‘ä¹Ÿæ”¶å·¥ã€‚")
}

func main() {
	// 1. åˆ›å»ºä¸€ä¸ªæ— ç¼“å†²ç®¡é“ï¼ˆä¼ èœå£ï¼‰
	// ç‰¹ç‚¹ï¼šç›˜å­æ”¾ä¸Šå»ï¼Œå¿…é¡»é©¬ä¸Šè¢«äººæ‹¿èµ°ï¼Œå¦åˆ™æ‰‹ç¼©ä¸å›æ¥
	kitchenChannel := make(chan string)

	// 2. è®©å¨å¸ˆåœ¨ä¸€ä¸ªæ–°çš„ Goroutine é‡Œå·¥ä½œ
	go chef(kitchenChannel)

	// 3. æœåŠ¡å‘˜åœ¨ä¸» Goroutine é‡Œå·¥ä½œ
	// è¿™æ ·å¯ä»¥é˜²æ­¢ main å‡½æ•°æå‰é€€å‡º
	waiter(kitchenChannel)
}
