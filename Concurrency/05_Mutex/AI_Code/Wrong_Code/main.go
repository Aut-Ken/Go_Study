package main

import (
	"fmt"
	"sync" // å¼•å…¥ sync åŒ…ï¼Œæˆ‘ä»¬è¦ç”¨ WaitGroup æ¥ç­‰å¾…åç¨‹ç»“æŸ
)

// å…¨å±€å˜é‡ï¼šé“¶è¡Œä½™é¢
var balance int = 0

// å­˜æ¬¾å‡½æ•°ï¼šæ¯æ¬¡åªå­˜ 1 å—é’±ï¼Œå­˜ 10000 æ¬¡
func deposit(wg *sync.WaitGroup) {
	for i := 0; i < 10000; i++ {
		// âš ï¸ å±é™©æ“ä½œï¼šæŠŠä½™é¢æ‹¿å‡ºæ¥ï¼ŒåŠ  1ï¼Œå†æ”¾å›å»
		balance = balance + 1
	}
	wg.Done() // å‘Šè¯‰ä¸»ç¨‹ï¼šæˆ‘å¹²å®Œæ´»äº†
}

func main() {
	// WaitGroup æ˜¯ç”¨æ¥ç­‰å¾…ä¸€ç»„ Goroutine ç»“æŸçš„ç¥å™¨
	// (ä¸ç”¨æ·±ç©¶å®ƒçš„è¯­æ³•ï¼Œåªè¦çŸ¥é“å®ƒèƒ½å¸®æˆ‘ä»¬è¦æ­»ç­‰ 2 ä¸ªåç¨‹å¹²å®Œæ´»)
	var wg sync.WaitGroup
	wg.Add(2) // æˆ‘ä»¬è¦æœ‰ 2 ä¸ªåç¨‹

	// å¼€å¯ä¸¤ä¸ªåç¨‹ï¼ŒåŒæ—¶å»æŠ¢ç€å­˜é’±
	go deposit(&wg) // åç¨‹ A
	go deposit(&wg) // åç¨‹ B

	// ç­‰å¾…ä¸¤ä¸ªåç¨‹éƒ½ç»“æŸ
	wg.Wait()

	fmt.Printf("ğŸ’° æœ€ç»ˆä½™é¢: %d\n", balance)
}
